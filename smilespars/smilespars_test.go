package smilespars

import (
	"testing"
)

func TestLexerRun(t *testing.T) {
	src := "O(c1ccc(cc1)COCCOC(C)C)CC(O)CNC(C)C\r\n" +
		"O=C(N)Cc1ccc(cc1)OCC(O)CNC(C)C\r" +
		"O[C@H](c1cc(O)ccc1)CNC\n" +
		"C1=CC(=C(C=C1CCN)O)O\n" +
		"C1=CC(=C(C=C1C(CN)O)O)O\n" +
		"CNC[C@H](O)c1ccc(O)c(O)c1\n" +
		"c1ccccc1N2N(C)C(C)=C(C2=O)N(C)CS(=O)(=O)O\n" +
		"O=C2N(c1ccccc1)N(C(=O)C2CCCC)c3ccccc3\n" +
		"O=C1C=C(C)N(C)N1c2ccccc2\n" +
		"CC1=C(C(=O)N(N1C)C2=CC=CC=C2)N(C)C\n" +
		"CC1([C@@H](N2[C@H](S1)[C@@H](C2=O)NC(=O)Cc3ccccc3)C(=O)O)C\n" +
		"[H][C@]12SC(C)(C)[C@@H](N1C(=O)[C@H]2NC(=O)C1=C(C)ON=C1C1=CC=CC=C1)C(O)=O\n" +
		"O=C(O)[C@@H]2N3C(=O)[C@@H](NC(=O)[C@@H](c1ccc(O)cc1)N)[C@H]3SC2(C)C\n" +
		"CC1(C(N2C(S1)C(C2=O)NC(=O)C(C3=CC=CC=C3)N)C(=O)O)C"

	expectedRes := "ALIPHATIC_ORGANIC (1, 1)-(1, 2): O\nL_ROUND_PAREN (1, 2)-(1, 3): \nAROMATIC_ORGANIC (1, 3)-(1, 4): c\nDIGIT (1, 4)-(1, 5): 1\nAROMATIC_ORGANIC (1, 5)-(1, 6): c\nAROMATIC_ORGANIC (1, 6)-(1, 7): c\nAROMATIC_ORGANIC (1, 7)-(1, 8): c\nL_ROUND_PAREN (1, 8)-(1, 9): \nAROMATIC_ORGANIC (1, 9)-(1, 10): c\nAROMATIC_ORGANIC (1, 10)-(1, 11): c\nDIGIT (1, 11)-(1, 12): 1\nR_ROUND_PAREN (1, 12)-(1, 13): \nALIPHATIC_ORGANIC (1, 13)-(1, 14): C\nALIPHATIC_ORGANIC (1, 14)-(1, 15): O\nALIPHATIC_ORGANIC (1, 15)-(1, 16): C\nALIPHATIC_ORGANIC (1, 16)-(1, 17): C\nALIPHATIC_ORGANIC (1, 17)-(1, 18): O\nALIPHATIC_ORGANIC (1, 18)-(1, 19): C\nL_ROUND_PAREN (1, 19)-(1, 20): \nALIPHATIC_ORGANIC (1, 20)-(1, 21): C\nR_ROUND_PAREN (1, 21)-(1, 22): \nALIPHATIC_ORGANIC (1, 22)-(1, 23): C\nR_ROUND_PAREN (1, 23)-(1, 24): \nALIPHATIC_ORGANIC (1, 24)-(1, 25): C\nALIPHATIC_ORGANIC (1, 25)-(1, 26): C\nL_ROUND_PAREN (1, 26)-(1, 27): \nALIPHATIC_ORGANIC (1, 27)-(1, 28): O\nR_ROUND_PAREN (1, 28)-(1, 29): \nALIPHATIC_ORGANIC (1, 29)-(1, 30): C\nALIPHATIC_ORGANIC (1, 30)-(1, 31): N\nALIPHATIC_ORGANIC (1, 31)-(1, 32): C\nL_ROUND_PAREN (1, 32)-(1, 33): \nALIPHATIC_ORGANIC (1, 33)-(1, 34): C\nR_ROUND_PAREN (1, 34)-(1, 35): \nALIPHATIC_ORGANIC (1, 35)-(1, 36): C\nEND_OF_STRING (1, 36)-(2, 1): \nALIPHATIC_ORGANIC (2, 1)-(2, 2): O\nEQUAL (2, 2)-(2, 3): \nALIPHATIC_ORGANIC (2, 3)-(2, 4): C\nL_ROUND_PAREN (2, 4)-(2, 5): \nALIPHATIC_ORGANIC (2, 5)-(2, 6): N\nR_ROUND_PAREN (2, 6)-(2, 7): \nALIPHATIC_ORGANIC (2, 7)-(2, 8): C\nAROMATIC_ORGANIC (2, 8)-(2, 9): c\nDIGIT (2, 9)-(2, 10): 1\nAROMATIC_ORGANIC (2, 10)-(2, 11): c\nAROMATIC_ORGANIC (2, 11)-(2, 12): c\nAROMATIC_ORGANIC (2, 12)-(2, 13): c\nL_ROUND_PAREN (2, 13)-(2, 14): \nAROMATIC_ORGANIC (2, 14)-(2, 15): c\nAROMATIC_ORGANIC (2, 15)-(2, 16): c\nDIGIT (2, 16)-(2, 17): 1\nR_ROUND_PAREN (2, 17)-(2, 18): \nALIPHATIC_ORGANIC (2, 18)-(2, 19): O\nALIPHATIC_ORGANIC (2, 19)-(2, 20): C\nALIPHATIC_ORGANIC (2, 20)-(2, 21): C\nL_ROUND_PAREN (2, 21)-(2, 22): \nALIPHATIC_ORGANIC (2, 22)-(2, 23): O\nR_ROUND_PAREN (2, 23)-(2, 24): \nALIPHATIC_ORGANIC (2, 24)-(2, 25): C\nALIPHATIC_ORGANIC (2, 25)-(2, 26): N\nALIPHATIC_ORGANIC (2, 26)-(2, 27): C\nL_ROUND_PAREN (2, 27)-(2, 28): \nALIPHATIC_ORGANIC (2, 28)-(2, 29): C\nR_ROUND_PAREN (2, 29)-(2, 30): \nALIPHATIC_ORGANIC (2, 30)-(2, 31): C\nCARRIAGE_RETURN (2, 31)-(3, 1): \nALIPHATIC_ORGANIC (3, 1)-(3, 2): O\nL_SQUARE_PAREN (3, 2)-(3, 3): \nALIPHATIC_ORGANIC (3, 3)-(3, 4): C\nCHIRAL (3, 4)-(3, 5): @\nH_SYMBOL (3, 5)-(3, 6): H\nR_SQUARE_PAREN (3, 6)-(3, 7): \nL_ROUND_PAREN (3, 7)-(3, 8): \nAROMATIC_ORGANIC (3, 8)-(3, 9): c\nDIGIT (3, 9)-(3, 10): 1\nAROMATIC_ORGANIC (3, 10)-(3, 11): c\nAROMATIC_ORGANIC (3, 11)-(3, 12): c\nL_ROUND_PAREN (3, 12)-(3, 13): \nALIPHATIC_ORGANIC (3, 13)-(3, 14): O\nR_ROUND_PAREN (3, 14)-(3, 15): \nAROMATIC_ORGANIC (3, 15)-(3, 16): c\nAROMATIC_ORGANIC (3, 16)-(3, 17): c\nAROMATIC_ORGANIC (3, 17)-(3, 18): c\nDIGIT (3, 18)-(3, 19): 1\nR_ROUND_PAREN (3, 19)-(3, 20): \nALIPHATIC_ORGANIC (3, 20)-(3, 21): C\nALIPHATIC_ORGANIC (3, 21)-(3, 22): N\nALIPHATIC_ORGANIC (3, 22)-(3, 23): C\nLINE_FEED------------------------------------ (3, 23)-(4, 1): \nALIPHATIC_ORGANIC (4, 1)-(4, 2): C\nDIGIT (4, 2)-(4, 3): 1\nEQUAL (4, 3)-(4, 4): \nALIPHATIC_ORGANIC (4, 4)-(4, 5): C\nALIPHATIC_ORGANIC (4, 5)-(4, 6): C\nL_ROUND_PAREN (4, 6)-(4, 7): \nEQUAL (4, 7)-(4, 8): \nALIPHATIC_ORGANIC (4, 8)-(4, 9): C\nL_ROUND_PAREN (4, 9)-(4, 10): \nALIPHATIC_ORGANIC (4, 10)-(4, 11): C\nEQUAL (4, 11)-(4, 12): \nALIPHATIC_ORGANIC (4, 12)-(4, 13): C\nDIGIT (4, 13)-(4, 14): 1\nALIPHATIC_ORGANIC (4, 14)-(4, 15): C\nALIPHATIC_ORGANIC (4, 15)-(4, 16): C\nALIPHATIC_ORGANIC (4, 16)-(4, 17): N\nR_ROUND_PAREN (4, 17)-(4, 18): \nALIPHATIC_ORGANIC (4, 18)-(4, 19): O\nR_ROUND_PAREN (4, 19)-(4, 20): \nALIPHATIC_ORGANIC (4, 20)-(4, 21): O\nLINE_FEED------------------------------------ (4, 21)-(5, 1): \nALIPHATIC_ORGANIC (5, 1)-(5, 2): C\nDIGIT (5, 2)-(5, 3): 1\nEQUAL (5, 3)-(5, 4): \nALIPHATIC_ORGANIC (5, 4)-(5, 5): C\nALIPHATIC_ORGANIC (5, 5)-(5, 6): C\nL_ROUND_PAREN (5, 6)-(5, 7): \nEQUAL (5, 7)-(5, 8): \nALIPHATIC_ORGANIC (5, 8)-(5, 9): C\nL_ROUND_PAREN (5, 9)-(5, 10): \nALIPHATIC_ORGANIC (5, 10)-(5, 11): C\nEQUAL (5, 11)-(5, 12): \nALIPHATIC_ORGANIC (5, 12)-(5, 13): C\nDIGIT (5, 13)-(5, 14): 1\nALIPHATIC_ORGANIC (5, 14)-(5, 15): C\nL_ROUND_PAREN (5, 15)-(5, 16): \nALIPHATIC_ORGANIC (5, 16)-(5, 17): C\nALIPHATIC_ORGANIC (5, 17)-(5, 18): N\nR_ROUND_PAREN (5, 18)-(5, 19): \nALIPHATIC_ORGANIC (5, 19)-(5, 20): O\nR_ROUND_PAREN (5, 20)-(5, 21): \nALIPHATIC_ORGANIC (5, 21)-(5, 22): O\nR_ROUND_PAREN (5, 22)-(5, 23): \nALIPHATIC_ORGANIC (5, 23)-(5, 24): O\nLINE_FEED------------------------------------ (5, 24)-(6, 1): \nALIPHATIC_ORGANIC (6, 1)-(6, 2): C\nALIPHATIC_ORGANIC (6, 2)-(6, 3): N\nALIPHATIC_ORGANIC (6, 3)-(6, 4): C\nL_SQUARE_PAREN (6, 4)-(6, 5): \nALIPHATIC_ORGANIC (6, 5)-(6, 6): C\nCHIRAL (6, 6)-(6, 7): @\nH_SYMBOL (6, 7)-(6, 8): H\nR_SQUARE_PAREN (6, 8)-(6, 9): \nL_ROUND_PAREN (6, 9)-(6, 10): \nALIPHATIC_ORGANIC (6, 10)-(6, 11): O\nR_ROUND_PAREN (6, 11)-(6, 12): \nAROMATIC_ORGANIC (6, 12)-(6, 13): c\nDIGIT (6, 13)-(6, 14): 1\nAROMATIC_ORGANIC (6, 14)-(6, 15): c\nAROMATIC_ORGANIC (6, 15)-(6, 16): c\nAROMATIC_ORGANIC (6, 16)-(6, 17): c\nL_ROUND_PAREN (6, 17)-(6, 18): \nALIPHATIC_ORGANIC (6, 18)-(6, 19): O\nR_ROUND_PAREN (6, 19)-(6, 20): \nAROMATIC_ORGANIC (6, 20)-(6, 21): c\nL_ROUND_PAREN (6, 21)-(6, 22): \nALIPHATIC_ORGANIC (6, 22)-(6, 23): O\nR_ROUND_PAREN (6, 23)-(6, 24): \nAROMATIC_ORGANIC (6, 24)-(6, 25): c\nDIGIT (6, 25)-(6, 26): 1\nLINE_FEED------------------------------------ (6, 26)-(7, 1): \nAROMATIC_ORGANIC (7, 1)-(7, 2): c\nDIGIT (7, 2)-(7, 3): 1\nAROMATIC_ORGANIC (7, 3)-(7, 4): c\nAROMATIC_ORGANIC (7, 4)-(7, 5): c\nAROMATIC_ORGANIC (7, 5)-(7, 6): c\nAROMATIC_ORGANIC (7, 6)-(7, 7): c\nAROMATIC_ORGANIC (7, 7)-(7, 8): c\nDIGIT (7, 8)-(7, 9): 1\nALIPHATIC_ORGANIC (7, 9)-(7, 10): N\nDIGIT (7, 10)-(7, 11): 2\nALIPHATIC_ORGANIC (7, 11)-(7, 12): N\nL_ROUND_PAREN (7, 12)-(7, 13): \nALIPHATIC_ORGANIC (7, 13)-(7, 14): C\nR_ROUND_PAREN (7, 14)-(7, 15): \nALIPHATIC_ORGANIC (7, 15)-(7, 16): C\nL_ROUND_PAREN (7, 16)-(7, 17): \nALIPHATIC_ORGANIC (7, 17)-(7, 18): C\nR_ROUND_PAREN (7, 18)-(7, 19): \nEQUAL (7, 19)-(7, 20): \nALIPHATIC_ORGANIC (7, 20)-(7, 21): C\nL_ROUND_PAREN (7, 21)-(7, 22): \nALIPHATIC_ORGANIC (7, 22)-(7, 23): C\nDIGIT (7, 23)-(7, 24): 2\nEQUAL (7, 24)-(7, 25): \nALIPHATIC_ORGANIC (7, 25)-(7, 26): O\nR_ROUND_PAREN (7, 26)-(7, 27): \nALIPHATIC_ORGANIC (7, 27)-(7, 28): N\nL_ROUND_PAREN (7, 28)-(7, 29): \nALIPHATIC_ORGANIC (7, 29)-(7, 30): C\nR_ROUND_PAREN (7, 30)-(7, 31): \nALIPHATIC_ORGANIC (7, 31)-(7, 32): C\nALIPHATIC_ORGANIC (7, 32)-(7, 33): S\nL_ROUND_PAREN (7, 33)-(7, 34): \nEQUAL (7, 34)-(7, 35): \nALIPHATIC_ORGANIC (7, 35)-(7, 36): O\nR_ROUND_PAREN (7, 36)-(7, 37): \nL_ROUND_PAREN (7, 37)-(7, 38): \nEQUAL (7, 38)-(7, 39): \nALIPHATIC_ORGANIC (7, 39)-(7, 40): O\nR_ROUND_PAREN (7, 40)-(7, 41): \nALIPHATIC_ORGANIC (7, 41)-(7, 42): O\nLINE_FEED------------------------------------ (7, 42)-(8, 1): \nALIPHATIC_ORGANIC (8, 1)-(8, 2): O\nEQUAL (8, 2)-(8, 3): \nALIPHATIC_ORGANIC (8, 3)-(8, 4): C\nDIGIT (8, 4)-(8, 5): 2\nALIPHATIC_ORGANIC (8, 5)-(8, 6): N\nL_ROUND_PAREN (8, 6)-(8, 7): \nAROMATIC_ORGANIC (8, 7)-(8, 8): c\nDIGIT (8, 8)-(8, 9): 1\nAROMATIC_ORGANIC (8, 9)-(8, 10): c\nAROMATIC_ORGANIC (8, 10)-(8, 11): c\nAROMATIC_ORGANIC (8, 11)-(8, 12): c\nAROMATIC_ORGANIC (8, 12)-(8, 13): c\nAROMATIC_ORGANIC (8, 13)-(8, 14): c\nDIGIT (8, 14)-(8, 15): 1\nR_ROUND_PAREN (8, 15)-(8, 16): \nALIPHATIC_ORGANIC (8, 16)-(8, 17): N\nL_ROUND_PAREN (8, 17)-(8, 18): \nALIPHATIC_ORGANIC (8, 18)-(8, 19): C\nL_ROUND_PAREN (8, 19)-(8, 20): \nEQUAL (8, 20)-(8, 21): \nALIPHATIC_ORGANIC (8, 21)-(8, 22): O\nR_ROUND_PAREN (8, 22)-(8, 23): \nALIPHATIC_ORGANIC (8, 23)-(8, 24): C\nDIGIT (8, 24)-(8, 25): 2\nALIPHATIC_ORGANIC (8, 25)-(8, 26): C\nALIPHATIC_ORGANIC (8, 26)-(8, 27): C\nALIPHATIC_ORGANIC (8, 27)-(8, 28): C\nALIPHATIC_ORGANIC (8, 28)-(8, 29): C\nR_ROUND_PAREN (8, 29)-(8, 30): \nAROMATIC_ORGANIC (8, 30)-(8, 31): c\nDIGIT (8, 31)-(8, 32): 3\nAROMATIC_ORGANIC (8, 32)-(8, 33): c\nAROMATIC_ORGANIC (8, 33)-(8, 34): c\nAROMATIC_ORGANIC (8, 34)-(8, 35): c\nAROMATIC_ORGANIC (8, 35)-(8, 36): c\nAROMATIC_ORGANIC (8, 36)-(8, 37): c\nDIGIT (8, 37)-(8, 38): 3\nLINE_FEED------------------------------------ (8, 38)-(9, 1): \nALIPHATIC_ORGANIC (9, 1)-(9, 2): O\nEQUAL (9, 2)-(9, 3): \nALIPHATIC_ORGANIC (9, 3)-(9, 4): C\nDIGIT (9, 4)-(9, 5): 1\nALIPHATIC_ORGANIC (9, 5)-(9, 6): C\nEQUAL (9, 6)-(9, 7): \nALIPHATIC_ORGANIC (9, 7)-(9, 8): C\nL_ROUND_PAREN (9, 8)-(9, 9): \nALIPHATIC_ORGANIC (9, 9)-(9, 10): C\nR_ROUND_PAREN (9, 10)-(9, 11): \nALIPHATIC_ORGANIC (9, 11)-(9, 12): N\nL_ROUND_PAREN (9, 12)-(9, 13): \nALIPHATIC_ORGANIC (9, 13)-(9, 14): C\nR_ROUND_PAREN (9, 14)-(9, 15): \nALIPHATIC_ORGANIC (9, 15)-(9, 16): N\nDIGIT (9, 16)-(9, 17): 1\nAROMATIC_ORGANIC (9, 17)-(9, 18): c\nDIGIT (9, 18)-(9, 19): 2\nAROMATIC_ORGANIC (9, 19)-(9, 20): c\nAROMATIC_ORGANIC (9, 20)-(9, 21): c\nAROMATIC_ORGANIC (9, 21)-(9, 22): c\nAROMATIC_ORGANIC (9, 22)-(9, 23): c\nAROMATIC_ORGANIC (9, 23)-(9, 24): c\nDIGIT (9, 24)-(9, 25): 2\nLINE_FEED------------------------------------ (9, 25)-(10, 1): \nALIPHATIC_ORGANIC (10, 1)-(10, 2): C\nALIPHATIC_ORGANIC (10, 2)-(10, 3): C\nDIGIT (10, 3)-(10, 4): 1\nEQUAL (10, 4)-(10, 5): \nALIPHATIC_ORGANIC (10, 5)-(10, 6): C\nL_ROUND_PAREN (10, 6)-(10, 7): \nALIPHATIC_ORGANIC (10, 7)-(10, 8): C\nL_ROUND_PAREN (10, 8)-(10, 9): \nEQUAL (10, 9)-(10, 10): \nALIPHATIC_ORGANIC (10, 10)-(10, 11): O\nR_ROUND_PAREN (10, 11)-(10, 12): \nALIPHATIC_ORGANIC (10, 12)-(10, 13): N\nL_ROUND_PAREN (10, 13)-(10, 14): \nALIPHATIC_ORGANIC (10, 14)-(10, 15): N\nDIGIT (10, 15)-(10, 16): 1\nALIPHATIC_ORGANIC (10, 16)-(10, 17): C\nR_ROUND_PAREN (10, 17)-(10, 18): \nALIPHATIC_ORGANIC (10, 18)-(10, 19): C\nDIGIT (10, 19)-(10, 20): 2\nEQUAL (10, 20)-(10, 21): \nALIPHATIC_ORGANIC (10, 21)-(10, 22): C\nALIPHATIC_ORGANIC (10, 22)-(10, 23): C\nEQUAL (10, 23)-(10, 24): \nALIPHATIC_ORGANIC (10, 24)-(10, 25): C\nALIPHATIC_ORGANIC (10, 25)-(10, 26): C\nEQUAL (10, 26)-(10, 27): \nALIPHATIC_ORGANIC (10, 27)-(10, 28): C\nDIGIT (10, 28)-(10, 29): 2\nR_ROUND_PAREN (10, 29)-(10, 30): \nALIPHATIC_ORGANIC (10, 30)-(10, 31): N\nL_ROUND_PAREN (10, 31)-(10, 32): \nALIPHATIC_ORGANIC (10, 32)-(10, 33): C\nR_ROUND_PAREN (10, 33)-(10, 34): \nALIPHATIC_ORGANIC (10, 34)-(10, 35): C\nLINE_FEED------------------------------------ (10, 35)-(11, 1): \nALIPHATIC_ORGANIC (11, 1)-(11, 2): C\nALIPHATIC_ORGANIC (11, 2)-(11, 3): C\nDIGIT (11, 3)-(11, 4): 1\nL_ROUND_PAREN (11, 4)-(11, 5): \nL_SQUARE_PAREN (11, 5)-(11, 6): \nALIPHATIC_ORGANIC (11, 6)-(11, 7): C\nCHIRAL (11, 7)-(11, 9): @@\nH_SYMBOL (11, 9)-(11, 10): H\nR_SQUARE_PAREN (11, 10)-(11, 11): \nL_ROUND_PAREN (11, 11)-(11, 12): \nALIPHATIC_ORGANIC (11, 12)-(11, 13): N\nDIGIT (11, 13)-(11, 14): 2\nL_SQUARE_PAREN (11, 14)-(11, 15): \nALIPHATIC_ORGANIC (11, 15)-(11, 16): C\nCHIRAL (11, 16)-(11, 17): @\nH_SYMBOL (11, 17)-(11, 18): H\nR_SQUARE_PAREN (11, 18)-(11, 19): \nL_ROUND_PAREN (11, 19)-(11, 20): \nALIPHATIC_ORGANIC (11, 20)-(11, 21): S\nDIGIT (11, 21)-(11, 22): 1\nR_ROUND_PAREN (11, 22)-(11, 23): \nL_SQUARE_PAREN (11, 23)-(11, 24): \nALIPHATIC_ORGANIC (11, 24)-(11, 25): C\nCHIRAL (11, 25)-(11, 27): @@\nH_SYMBOL (11, 27)-(11, 28): H\nR_SQUARE_PAREN (11, 28)-(11, 29): \nL_ROUND_PAREN (11, 29)-(11, 30): \nALIPHATIC_ORGANIC (11, 30)-(11, 31): C\nDIGIT (11, 31)-(11, 32): 2\nEQUAL (11, 32)-(11, 33): \nALIPHATIC_ORGANIC (11, 33)-(11, 34): O\nR_ROUND_PAREN (11, 34)-(11, 35): \nALIPHATIC_ORGANIC (11, 35)-(11, 36): N\nALIPHATIC_ORGANIC (11, 36)-(11, 37): C\nL_ROUND_PAREN (11, 37)-(11, 38): \nEQUAL (11, 38)-(11, 39): \nALIPHATIC_ORGANIC (11, 39)-(11, 40): O\nR_ROUND_PAREN (11, 40)-(11, 41): \nALIPHATIC_ORGANIC (11, 41)-(11, 42): C\nAROMATIC_ORGANIC (11, 42)-(11, 43): c\nDIGIT (11, 43)-(11, 44): 3\nAROMATIC_ORGANIC (11, 44)-(11, 45): c\nAROMATIC_ORGANIC (11, 45)-(11, 46): c\nAROMATIC_ORGANIC (11, 46)-(11, 47): c\nAROMATIC_ORGANIC (11, 47)-(11, 48): c\nAROMATIC_ORGANIC (11, 48)-(11, 49): c\nDIGIT (11, 49)-(11, 50): 3\nR_ROUND_PAREN (11, 50)-(11, 51): \nALIPHATIC_ORGANIC (11, 51)-(11, 52): C\nL_ROUND_PAREN (11, 52)-(11, 53): \nEQUAL (11, 53)-(11, 54): \nALIPHATIC_ORGANIC (11, 54)-(11, 55): O\nR_ROUND_PAREN (11, 55)-(11, 56): \nALIPHATIC_ORGANIC (11, 56)-(11, 57): O\nR_ROUND_PAREN (11, 57)-(11, 58): \nALIPHATIC_ORGANIC (11, 58)-(11, 59): C\nLINE_FEED------------------------------------ (11, 59)-(12, 1): \nL_SQUARE_PAREN (12, 1)-(12, 2): \nH_SYMBOL (12, 2)-(12, 3): H\nR_SQUARE_PAREN (12, 3)-(12, 4): \nL_SQUARE_PAREN (12, 4)-(12, 5): \nALIPHATIC_ORGANIC (12, 5)-(12, 6): C\nCHIRAL (12, 6)-(12, 7): @\nR_SQUARE_PAREN (12, 7)-(12, 8): \nDIGIT (12, 8)-(12, 9): 1\nDIGIT (12, 9)-(12, 10): 2\nALIPHATIC_ORGANIC (12, 10)-(12, 11): S\nALIPHATIC_ORGANIC (12, 11)-(12, 12): C\nL_ROUND_PAREN (12, 12)-(12, 13): \nALIPHATIC_ORGANIC (12, 13)-(12, 14): C\nR_ROUND_PAREN (12, 14)-(12, 15): \nL_ROUND_PAREN (12, 15)-(12, 16): \nALIPHATIC_ORGANIC (12, 16)-(12, 17): C\nR_ROUND_PAREN (12, 17)-(12, 18): \nL_SQUARE_PAREN (12, 18)-(12, 19): \nALIPHATIC_ORGANIC (12, 19)-(12, 20): C\nCHIRAL (12, 20)-(12, 22): @@\nH_SYMBOL (12, 22)-(12, 23): H\nR_SQUARE_PAREN (12, 23)-(12, 24): \nL_ROUND_PAREN (12, 24)-(12, 25): \nALIPHATIC_ORGANIC (12, 25)-(12, 26): N\nDIGIT (12, 26)-(12, 27): 1\nALIPHATIC_ORGANIC (12, 27)-(12, 28): C\nL_ROUND_PAREN (12, 28)-(12, 29): \nEQUAL (12, 29)-(12, 30): \nALIPHATIC_ORGANIC (12, 30)-(12, 31): O\nR_ROUND_PAREN (12, 31)-(12, 32): \nL_SQUARE_PAREN (12, 32)-(12, 33): \nALIPHATIC_ORGANIC (12, 33)-(12, 34): C\nCHIRAL (12, 34)-(12, 35): @\nH_SYMBOL (12, 35)-(12, 36): H\nR_SQUARE_PAREN (12, 36)-(12, 37): \nDIGIT (12, 37)-(12, 38): 2\nALIPHATIC_ORGANIC (12, 38)-(12, 39): N\nALIPHATIC_ORGANIC (12, 39)-(12, 40): C\nL_ROUND_PAREN (12, 40)-(12, 41): \nEQUAL (12, 41)-(12, 42): \nALIPHATIC_ORGANIC (12, 42)-(12, 43): O\nR_ROUND_PAREN (12, 43)-(12, 44): \nALIPHATIC_ORGANIC (12, 44)-(12, 45): C\nDIGIT (12, 45)-(12, 46): 1\nEQUAL (12, 46)-(12, 47): \nALIPHATIC_ORGANIC (12, 47)-(12, 48): C\nL_ROUND_PAREN (12, 48)-(12, 49): \nALIPHATIC_ORGANIC (12, 49)-(12, 50): C\nR_ROUND_PAREN (12, 50)-(12, 51): \nALIPHATIC_ORGANIC (12, 51)-(12, 52): O\nALIPHATIC_ORGANIC (12, 52)-(12, 53): N\nEQUAL (12, 53)-(12, 54): \nALIPHATIC_ORGANIC (12, 54)-(12, 55): C\nDIGIT (12, 55)-(12, 56): 1\nALIPHATIC_ORGANIC (12, 56)-(12, 57): C\nDIGIT (12, 57)-(12, 58): 1\nEQUAL (12, 58)-(12, 59): \nALIPHATIC_ORGANIC (12, 59)-(12, 60): C\nALIPHATIC_ORGANIC (12, 60)-(12, 61): C\nEQUAL (12, 61)-(12, 62): \nALIPHATIC_ORGANIC (12, 62)-(12, 63): C\nALIPHATIC_ORGANIC (12, 63)-(12, 64): C\nEQUAL (12, 64)-(12, 65): \nALIPHATIC_ORGANIC (12, 65)-(12, 66): C\nDIGIT (12, 66)-(12, 67): 1\nR_ROUND_PAREN (12, 67)-(12, 68): \nALIPHATIC_ORGANIC (12, 68)-(12, 69): C\nL_ROUND_PAREN (12, 69)-(12, 70): \nALIPHATIC_ORGANIC (12, 70)-(12, 71): O\nR_ROUND_PAREN (12, 71)-(12, 72): \nEQUAL (12, 72)-(12, 73): \nALIPHATIC_ORGANIC (12, 73)-(12, 74): O\nLINE_FEED------------------------------------ (12, 74)-(13, 1): \nALIPHATIC_ORGANIC (13, 1)-(13, 2): O\nEQUAL (13, 2)-(13, 3): \nALIPHATIC_ORGANIC (13, 3)-(13, 4): C\nL_ROUND_PAREN (13, 4)-(13, 5): \nALIPHATIC_ORGANIC (13, 5)-(13, 6): O\nR_ROUND_PAREN (13, 6)-(13, 7): \nL_SQUARE_PAREN (13, 7)-(13, 8): \nALIPHATIC_ORGANIC (13, 8)-(13, 9): C\nCHIRAL (13, 9)-(13, 11): @@\nH_SYMBOL (13, 11)-(13, 12): H\nR_SQUARE_PAREN (13, 12)-(13, 13): \nDIGIT (13, 13)-(13, 14): 2\nALIPHATIC_ORGANIC (13, 14)-(13, 15): N\nDIGIT (13, 15)-(13, 16): 3\nALIPHATIC_ORGANIC (13, 16)-(13, 17): C\nL_ROUND_PAREN (13, 17)-(13, 18): \nEQUAL (13, 18)-(13, 19): \nALIPHATIC_ORGANIC (13, 19)-(13, 20): O\nR_ROUND_PAREN (13, 20)-(13, 21): \nL_SQUARE_PAREN (13, 21)-(13, 22): \nALIPHATIC_ORGANIC (13, 22)-(13, 23): C\nCHIRAL (13, 23)-(13, 25): @@\nH_SYMBOL (13, 25)-(13, 26): H\nR_SQUARE_PAREN (13, 26)-(13, 27): \nL_ROUND_PAREN (13, 27)-(13, 28): \nALIPHATIC_ORGANIC (13, 28)-(13, 29): N\nALIPHATIC_ORGANIC (13, 29)-(13, 30): C\nL_ROUND_PAREN (13, 30)-(13, 31): \nEQUAL (13, 31)-(13, 32): \nALIPHATIC_ORGANIC (13, 32)-(13, 33): O\nR_ROUND_PAREN (13, 33)-(13, 34): \nL_SQUARE_PAREN (13, 34)-(13, 35): \nALIPHATIC_ORGANIC (13, 35)-(13, 36): C\nCHIRAL (13, 36)-(13, 38): @@\nH_SYMBOL (13, 38)-(13, 39): H\nR_SQUARE_PAREN (13, 39)-(13, 40): \nL_ROUND_PAREN (13, 40)-(13, 41): \nAROMATIC_ORGANIC (13, 41)-(13, 42): c\nDIGIT (13, 42)-(13, 43): 1\nAROMATIC_ORGANIC (13, 43)-(13, 44): c\nAROMATIC_ORGANIC (13, 44)-(13, 45): c\nAROMATIC_ORGANIC (13, 45)-(13, 46): c\nL_ROUND_PAREN (13, 46)-(13, 47): \nALIPHATIC_ORGANIC (13, 47)-(13, 48): O\nR_ROUND_PAREN (13, 48)-(13, 49): \nAROMATIC_ORGANIC (13, 49)-(13, 50): c\nAROMATIC_ORGANIC (13, 50)-(13, 51): c\nDIGIT (13, 51)-(13, 52): 1\nR_ROUND_PAREN (13, 52)-(13, 53): \nALIPHATIC_ORGANIC (13, 53)-(13, 54): N\nR_ROUND_PAREN (13, 54)-(13, 55): \nL_SQUARE_PAREN (13, 55)-(13, 56): \nALIPHATIC_ORGANIC (13, 56)-(13, 57): C\nCHIRAL (13, 57)-(13, 58): @\nH_SYMBOL (13, 58)-(13, 59): H\nR_SQUARE_PAREN (13, 59)-(13, 60): \nDIGIT (13, 60)-(13, 61): 3\nALIPHATIC_ORGANIC (13, 61)-(13, 62): S\nALIPHATIC_ORGANIC (13, 62)-(13, 63): C\nDIGIT (13, 63)-(13, 64): 2\nL_ROUND_PAREN (13, 64)-(13, 65): \nALIPHATIC_ORGANIC (13, 65)-(13, 66): C\nR_ROUND_PAREN (13, 66)-(13, 67): \nALIPHATIC_ORGANIC (13, 67)-(13, 68): C\nLINE_FEED------------------------------------ (13, 68)-(14, 1): \nALIPHATIC_ORGANIC (14, 1)-(14, 2): C\nALIPHATIC_ORGANIC (14, 2)-(14, 3): C\nDIGIT (14, 3)-(14, 4): 1\nL_ROUND_PAREN (14, 4)-(14, 5): \nALIPHATIC_ORGANIC (14, 5)-(14, 6): C\nL_ROUND_PAREN (14, 6)-(14, 7): \nALIPHATIC_ORGANIC (14, 7)-(14, 8): N\nDIGIT (14, 8)-(14, 9): 2\nALIPHATIC_ORGANIC (14, 9)-(14, 10): C\nL_ROUND_PAREN (14, 10)-(14, 11): \nALIPHATIC_ORGANIC (14, 11)-(14, 12): S\nDIGIT (14, 12)-(14, 13): 1\nR_ROUND_PAREN (14, 13)-(14, 14): \nALIPHATIC_ORGANIC (14, 14)-(14, 15): C\nL_ROUND_PAREN (14, 15)-(14, 16): \nALIPHATIC_ORGANIC (14, 16)-(14, 17): C\nDIGIT (14, 17)-(14, 18): 2\nEQUAL (14, 18)-(14, 19): \nALIPHATIC_ORGANIC (14, 19)-(14, 20): O\nR_ROUND_PAREN (14, 20)-(14, 21): \nALIPHATIC_ORGANIC (14, 21)-(14, 22): N\nALIPHATIC_ORGANIC (14, 22)-(14, 23): C\nL_ROUND_PAREN (14, 23)-(14, 24): \nEQUAL (14, 24)-(14, 25): \nALIPHATIC_ORGANIC (14, 25)-(14, 26): O\nR_ROUND_PAREN (14, 26)-(14, 27): \nALIPHATIC_ORGANIC (14, 27)-(14, 28): C\nL_ROUND_PAREN (14, 28)-(14, 29): \nALIPHATIC_ORGANIC (14, 29)-(14, 30): C\nDIGIT (14, 30)-(14, 31): 3\nEQUAL (14, 31)-(14, 32): \nALIPHATIC_ORGANIC (14, 32)-(14, 33): C\nALIPHATIC_ORGANIC (14, 33)-(14, 34): C\nEQUAL (14, 34)-(14, 35): \nALIPHATIC_ORGANIC (14, 35)-(14, 36): C\nALIPHATIC_ORGANIC (14, 36)-(14, 37): C\nEQUAL (14, 37)-(14, 38): \nALIPHATIC_ORGANIC (14, 38)-(14, 39): C\nDIGIT (14, 39)-(14, 40): 3\nR_ROUND_PAREN (14, 40)-(14, 41): \nALIPHATIC_ORGANIC (14, 41)-(14, 42): N\nR_ROUND_PAREN (14, 42)-(14, 43): \nALIPHATIC_ORGANIC (14, 43)-(14, 44): C\nL_ROUND_PAREN (14, 44)-(14, 45): \nEQUAL (14, 45)-(14, 46): \nALIPHATIC_ORGANIC (14, 46)-(14, 47): O\nR_ROUND_PAREN (14, 47)-(14, 48): \nALIPHATIC_ORGANIC (14, 48)-(14, 49): O\nR_ROUND_PAREN (14, 49)-(14, 50): \nALIPHATIC_ORGANIC (14, 50)-(14, 51): C\nEND_OF_FILE (14, 51)-(14, 51): \n"
	l := newLexer(src)
	tokens := l.run()
	res := ""
	for _, tok := range tokens {
		res += tok.String() + "\n"
	}
	if res == expectedRes {
		t.Log("Lexer test was successfully executed!")
	} else {
		t.Fatalf("Lexer test failed!")
	}

}

func TestReadGraphsFromSMILES(t *testing.T) {
	src := "O(c1ccc(cc1)COCCOC(C)C)CC(O)CNC(C)C\r\n" +
		"O=C(N)Cc1ccc(cc1)OCC(O)CNC(C)C\r" +
		"O[C@H](c1cc(O)ccc1)CNC\n" +
		"C1=CC(=C(C=C1CCN)O)O\n" +
		"C1=CC(=C(C=C1C(CN)O)O)O\n" +
		"CNC[C@H](O)c1ccc(O)c(O)c1\n" +
		"c1ccccc1N2N(C)C(C)=C(C2=O)N(C)CS(=O)(=O)O\n" +
		"O=C2N(c1ccccc1)N(C(=O)C2CCCC)c3ccccc3\n" +
		"O=C1C=C(C)N(C)N1c2ccccc2\n" +
		"CC1=C(C(=O)N(N1C)C2=CC=CC=C2)N(C)C\n" +
		"CC1([C@@H](N2[C@H](S1)[C@@H](C2=O)NC(=O)Cc3ccccc3)C(=O)O)C\n" +
		"[H][C@]12SC(C)(C)[C@@H](N1C(=O)[C@H]2NC(=O)C1=C(C)ON=C1C1=CC=CC=C1)C(O)=O\n" +
		"O=C(O)[C@@H]2N3C(=O)[C@@H](NC(=O)[C@@H](c1ccc(O)cc1)N)[C@H]3SC2(C)C\n" +
		"CC1(C(N2C(S1)C(C2=O)NC(=O)C(C3=CC=CC=C3)N)C(=O)O)C"
	ReadGraphsFromSMILES(src)
}