package cluster

import (
	"testing"
)

func compSlices(slice1 []int, slice2 []int) bool {
	if len(slice1) != len(slice2) {
		return false
	}

	for i, elem := range slice1 {
		if elem != slice2[i] {
			return false
		}
	}

	return true
}

func compSlicesOfSlices(sliceOfSlices1 [][]int, sliceOfSlices2 [][]int) bool {
	if len(sliceOfSlices1) != len(sliceOfSlices2) {
		return false
	}

	for i, slice1 := range sliceOfSlices1 {
		if !compSlices(slice1, sliceOfSlices2[i]) {
			return false
		}
	}

	return true
}

func TestCluster(t *testing.T) {
	data := []float64{0.5974358974358974, 0.272108843537415, 0.32066508313539194, 0.23284313725490197, 0.37950138504155123, 0.519163763066202, 0.2907488986784141, 0.3480278422273782, 0.7533783783783784, 0.6948529411764706, 0.2951167728237792, 0.34743875278396436, 0.8344594594594594, 0.6385135135135135, 0.918918918918919, 0.13984835720303285, 0.12709030100334448, 0.12314410480349346, 0.09155555555555556, 0.12628865979381443, 0.13810741687979539, 0.12896174863387977, 0.13716814159292035, 0.13380281690140844, 0.1100244498777506, 0.14434180138568128, 0.15209988649262202, 0.2629310344827586, 0.1375921375921376, 0.12454212454212454, 0.10269576379974327, 0.08683853459972862, 0.10087173100871731, 0.11138310893512852, 0.5890279114533205, 0.1947935368043088, 0.14152700186219738, 0.12950971322849214, 0.12197483059051308, 0.09226190476190477, 0.12333965844402277, 0.13533834586466165, 0.87776708373436, 0.24980842911877393, 0.6710526315789473, 0.16512215669755687, 0.19721980886185925, 0.1625441696113074, 0.12421805183199285, 0.1671018276762402, 0.18386816999132696, 0.3452456924058711, 0.29004329004329005, 0.23240469208211142, 0.3058668424522083, 0.16598079561042525, 0.16175462645647704, 0.12854181064270906, 0.09986033519553073, 0.13951890034364262, 0.15047879616963064, 0.4156450671336836, 0.3172715894868586, 0.2629582806573957, 0.370304114490161, 0.703678001387925, 0.17897271268057785, 0.20991735537190082, 0.17224080267558528, 0.13898305084745763, 0.18325041459369817, 0.2001654259718776, 0.36953807740324596, 0.30229325920778316, 0.24261603375527427, 0.3318298969072165, 0.9255411255411256, 0.703083109919571, 0.16397415185783523, 0.19071310116086235, 0.15851602023608768, 0.12, 0.1638935108153078, 0.1799336650082919, 0.3622641509433962, 0.2981715893108298, 0.2412562455389008, 0.32402597402597405, 0.9485359361135759, 0.7048846675712347, 0.9757575757575757}
	nPts := 14

	expected := [][]int{{12, 6, 7, 9, 10, 11, 13}, {1, 0, 2, 3, 4, 5}, {8}}

	res, err := Cluster(data, nPts)
	if err != nil {
		t.Fatalf("Clustering test failed!")
	}

	if compSlicesOfSlices(res, expected) {
		t.Log("Clustering test was successfully executed!")
	} else {
		t.Fatalf("Clustering test failed!")
	}
}
